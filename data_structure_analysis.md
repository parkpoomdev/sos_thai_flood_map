# การวิเคราะห์โครงสร้างข้อมูล SOS Flood

## โครงสร้างหลัก (Root Structure)

```json
{
  "fetched_at": "2025-11-25T15:01:08.983808",  // เวลาที่ดึงข้อมูล
  "data": {
    "data": [  // Array ของรายการ SOS
      // ... รายการต่างๆ
    ]
  }
}
```

## โครงสร้างของแต่ละรายการ SOS

แต่ละรายการใน `data.data` array มีโครงสร้างดังนี้:

### 1. ฟิลด์หลัก (Top-level Fields)

- **`_id`**: MongoDB ObjectId (เช่น `"69244cf44722a604e20c584b"`)
- **`running_number`**: เลขที่รายการ (เช่น `"HDY68-1124-0288"`)
- **`created_at`**: เวลาที่สร้างรายการ (ISO 8601 format)
- **`updated_at`**: เวลาที่อัปเดตล่าสุด (ISO 8601 format)
- **`location`**: GeoJSON Feature object

### 2. Location Object (GeoJSON Feature)

```json
{
  "type": "Feature",
  "properties": { /* ข้อมูลรายละเอียด */ },
  "geometry": {
    "type": "Point",
    "coordinates": [longitude, latitude]  // [100.468..., 6.991...]
  }
}
```

### 3. Properties Fields

#### ข้อมูลสถานที่
- **`province`**: จังหวัด (เช่น "สงขลา")
- **`district`**: อำเภอ (เช่น "หาดใหญ่")
- **`subdistrict`**: ตำบล (เช่น "คอหงส์")
- **`isIdAddress`**: boolean - ระบุว่าเป็นที่อยู่ที่ระบุ ID หรือไม่

#### ข้อมูลสถานะ
- **`status`**: สถานะการช่วยเหลือ
  - `0` = รอการช่วยเหลือ
  - `3` = กำลังดำเนินการช่วยเหลือ
- **`status_text`**: ข้อความสถานะ (เช่น "รอการช่วยเหลือ", "กำลังดำเนินการช่วยเหลือ...")
- **`status_color`**: HTML span สำหรับแสดงสีสถานะ
- **`specialStatus`**: boolean
- **`cleaning_status`**: boolean
- **`sharing_status`**: boolean

#### ข้อมูลประเภทคำขอ
- **`type`**: ตัวเลขประเภท (เช่น `1`, `5`, `9`)
- **`type_name`**: ชื่อประเภท
  - `"ป่วย/ติดต่อหมออาสา"` (type 1)
  - `"อพยพ/เคลื่อนย้ายออกนอกพื้นที่"` (type 5)
  - `"เตรียมอพยพ/เฝ้าระวัง"` (type 9)

#### ข้อมูลทางการแพทย์
- **`medic_status`**: สถานะทางการแพทย์ (เช่น `0` = รออาสาแพทย์ตรวจสอบ)
- **`medic_status_text`**: ข้อความสถานะทางการแพทย์
- **`sick_level_summary`**: ระดับความรุนแรง (1-4)
- **`patient`**: จำนวนผู้ป่วย (1 = มีผู้ป่วย)
- **`ages`**: อายุ (เช่น "98", "28", "60", "ไม่ระบุ")
- **`disease`**: โรคประจำตัว (เช่น "มีโรคประจำตัว", "ไม่มีโรคประจำตัว")

#### ข้อมูลผู้ประสบภัย
- **`victims`**: Array ของประเภทผู้ประสบภัย
  - `"เด็ก"` (เด็ก)
  - `"ผู้สูงอายุ"` (ผู้สูงอายุ)
  - `"คนพิการ"` (คนพิการ)
  - `"ทั่วไป"` (ทั่วไป)
- **`other`**: ข้อมูลเพิ่มเติม/หมายเหตุ (string หรือ null)

#### ข้อมูลไฟล์
- **`before_clean_files`**: Array ของไฟล์ก่อนทำความสะอาด
- **`after_clean_files`**: Array ของไฟล์หลังทำความสะอาด

#### ข้อมูลอื่นๆ
- **`name`**: ชื่อ (ส่วนใหญ่เป็น null)
- **`running_number`**: เลขที่รายการ (ซ้ำกับ top-level)

## ตัวอย่างข้อมูล

### ตัวอย่างที่ 1: รายการป่วย/ติดต่อหมออาสา (type 1)
```json
{
  "_id": "69244cf44722a604e20c584b",
  "location": {
    "type": "Feature",
    "properties": {
      "type": 1,
      "type_name": "ป่วย/ติดต่อหมออาสา",
      "status": 0,
      "status_text": "รอการช่วยเหลือ",
      "province": "สงขลา",
      "district": "หาดใหญ่",
      "subdistrict": "คอหงส์",
      "ages": "98",
      "disease": "มีโรคประจำตัว",
      "patient": 1,
      "other": "บ้านไม่มีน้ำไฟ ไม่มีสัญญาณโทรศัพท์..."
    },
    "geometry": {
      "type": "Point",
      "coordinates": [100.46814675757538, 6.991701304541705]
    }
  },
  "running_number": "HDY68-1124-0288"
}
```

### ตัวอย่างที่ 2: รายการอพยพ (type 5)
```json
{
  "_id": "69257f722273cecce00f6129",
  "location": {
    "properties": {
      "type": 5,
      "type_name": "อพยพ/เคลื่อนย้ายออกนอกพื้นที่",
      "status": 3,
      "status_text": "กำลังดำเนินการช่วยเหลือ...",
      "victims": ["เด็ก", "ผู้สูงอายุ", "ทั่วไป"]
    }
  }
}
```

## สรุปประเภทข้อมูล

1. **ประเภทคำขอ (type)**:
   - `1`: ป่วย/ติดต่อหมออาสา
   - `5`: อพยพ/เคลื่อนย้ายออกนอกพื้นที่
   - `9`: เตรียมอพยพ/เฝ้าระวัง

2. **สถานะ (status)**:
   - `0`: รอการช่วยเหลือ
   - `3`: กำลังดำเนินการช่วยเหลือ

3. **ระดับความรุนแรง (sick_level_summary)**:
   - `2`, `3`, `4`: ระดับความรุนแรง (ตัวเลขสูง = รุนแรงมากขึ้น)

4. **พิกัด (coordinates)**:
   - Format: `[longitude, latitude]`
   - ตัวอย่าง: `[100.468..., 6.991...]` (หาดใหญ่, สงขลา)


